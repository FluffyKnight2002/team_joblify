<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="_csrf" th:content="${_csrf.token}" />
<meta name="_csrf_header" th:content="${_csrf.headerName}" />
<title>Upload Vacancy</title>


<<<<<<< HEAD

<link rel="stylesheet" href="/assets/vendors/iconly/bold.css">
<link rel="stylesheet"
	href="assets/vendors/summernote/summernote-lite.min.css">
<link rel="stylesheet"
	href="/assets/vendors/perfect-scrollbar/perfect-scrollbar.css">
<link rel="stylesheet"
	href="/assets/vendors/bootstrap-icons/bootstrap-icons.css">
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/boxicons@2.1.4/css/boxicons.min.css">
<link rel="stylesheet" href="/assets/css/app.css">
<link rel="shortcut icon" href="/assets/images/favicon.svg"
	type="image/x-icon">
<link rel="stylesheet" href="assets/vendors/simple-datatables/style.css">
<link rel="stylesheet"
	href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css" />

<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
	rel="stylesheet">
=======
<link rel="stylesheet"
	href="assets/vendors/summernote/summernote-lite.min.css">
<link rel="stylesheet"
	href="assets/vendors/summernote/summernote-lite.min.css">
	<link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/bootstrap.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.5/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" href="/assets/vendors/perfect-scrollbar/perfect-scrollbar.css">
    <link rel="stylesheet" href="/assets/vendors/bootstrap-icons/bootstrap-icons.css">
    <link rel="stylesheet" href="/assets/css/app.css">
    <link rel="shortcut icon" href="/assets/images/favicon.svg" type="image/x-icon">

>>>>>>> backup
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.min.js"></script>


<style>
.view-details {
	cursor: pointer;
}

.info-table td th {
	width: max-content;
}

.view-details:hover {
	background: #435ebe;
	color: white;
}

tr.selected-row {
	background-color: #435ebe !important;
}
</style>
</head>

<body>
	<div id="app">
		<div th:replace="/fragments/dashboard-layout ::sidebar"></div>
		<div th:replace="/fragments/dashboard-layout ::layout-navbar"></div>
		<div id="main">
			<section class="section">
				<div class="row" id="table-striped">
					<div class="col-12">
						<div class="card">
						
							<div class="card-header">
							
								<h4 class="card-title">All Candidate's Interview Process</h4>
									<div class="d-flex flex-row">
										<button class="first-page btn btn-outline-primary">all Candidate</button>
									</div>
							
							</div>


							<div class="card-content">

								<div class="table-responsive">
									<p>Position
   									 <select id="positionSelect" class="position">
    								    <option value="">All</option>
  									  </select>
									</p>
<<<<<<< HEAD

									
									
									
									<table class="table " id="table1">
										<thead>
											<tr>
												<th id="select-all-checkbox"><input type="checkbox"
													id="selectAll">Select all</th>
=======
									
									<table class="table table-striped" id="table1">
										<thead>
											<tr>
											
												<th id="select-all-checkbox"><input type="checkbox"
													id="selectAll">All</th>
													<th></th>
>>>>>>> backup
												<th class="id">No.</th>
												<th>Name</th>
												<th>Position</th>
												<th>Selection Status</th>
<<<<<<< HEAD
												<th>Interview Invert Mail</th>
												<th>Interview Status</th>
												<th>Offer Mail</th>
												<th>See More</th>
												<th>Position</th>
=======
												<th >phone</th>
												<th >Interview Invert Mail</th>
												<th>Interview Status</th>
												<th >level</th>
												<th >Offer Mail</th>
												<th >experience</th>
												
												
>>>>>>> backup

											</tr>
										</thead>
										<tbody>

										</tbody>
									</table>
									

								</div>
							</div>
						</div>
					</div>
				</div>
			</section>
		</div>
	</div>
	<!-- Modal -->
	<div class="modal fade" id="seeMoreModal" tabindex="-1"
		aria-labelledby="seeMoreLabel" aria-hidden="true">
		<div
			class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
			<div class="modal-content">
				<div class="modal-header">
					<h1 class="modal-title fs-5" id="seeMoreLabel">Detail</h1>
				</div>
				<div class="modal-body">
					<div class="row">
						<div class="col-md-6">
						<label>Name -</label>
							<span  id="name"></span>
						</div>
						<div class="col-md-6">
						<label>Email -</label>
							<span  id="email"></span>
						</div>
						<div class="col-md-6">
						<label>Phone -</label>
							<span  id="phone"></span>
						</div>
						<div class="col-md-6">
							<label>Date of Birth -</label>
							<span id="dob"></span>
						</div>
						<div class="col-md-6">
							<label>Gender -</label>
							<span id="gender"></span>
						</div>
						<div class="col-md-6">
							<label>Specialist -</label>
							<span id="specialist"></span>
						</div>
						<div class="col-md-6">
							<label>Expected Salary -</label>
							<span id="expectedSalary"></span>
						</div>
						<div class="col-md-6">
							<label>Level -</label>
							<span id="level"></span>
						</div>
						<div class="col-md-6">
							<label>Experience -</label>
							<span id="experience"></span>
						</div>
						<div class="col-md-6">
							<label>Education -</label>
							<span id="education"></span>
						</div>
						<div class="col-md-6">
							<label>Apply Position -</label>
							<span id="applyPosition"></span>
						</div>
						
					</div>
					
                                        
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary"
						data-bs-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-primary">Update</button>
				</div>
			</div>
		</div>
	</div>

	<div class="modal fade" id="emailModal" tabindex="-1"
		aria-labelledby="sendEmail" aria-hidden="true">
		<div
			class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
			<div class="modal-content">
				<div class="modal-header">
					<h1 class="modal-title fs-5" id="emailModal"></h1>
					<button type="button" class="btn-close" data-bs-dismiss="modal"
						aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<form action="send-mail">
						<div class="card-body">
							<div class="col-md-4">
								<label>From</label>
							</div>
							<div class="col-md-8">
								<div class="form-group has-icon-left">
									<div class="position-relative">
										<input type="email" class="form-control userEmail" 
											id="first-name-icon">
										<div class="form-control-icon">
											<i class="bi bi-envelope"></i>
										</div>
									</div>
								</div>
							</div>
							<div class="col-md-4">
								<label>To</label>
							</div>
							<div class="col-md-8">
								<div class="form-group has-icon-left">
									<div class="position-relative">
										<input type="email" class="form-control candidatEmail"
											 id="first-name-icon" >
										<div class="form-control-icon">
											<i class="bi bi-envelope"></i>
										</div>
									</div>
								</div>
							</div>
							<div class="col-md-4">
								<label>CC Email</label>
							</div>
							<div class="col-md-8">
								<div class="form-group has-icon-left">
									<div class="position-relative">
										<input type="email" class="form-control" placeholder="Email"
											id="first-name-icon">
										<div class="form-control-icon">
											<i class="bi bi-envelope"></i>
										</div>
									</div>
								</div>
							</div>
							<div class="col-md-4">
								<label>Subject</label>
							</div>
							<div class="col-md-8">
								<input type="text" class="form-control" value="Invert Inteview "
									id="first-name-icon">
							</div>
							<br>
							<textarea class="summernote">Hello my fri<input type="text" id="time"/></textarea>


						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary"
						data-bs-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-primary" id="fetchValueButton">Send</button>
				</div>
			</div>
		</div>
	</div>
	<script type="text/javascript">
		
	</script>

	<script
		src="/assets/vendors/perfect-scrollbar/perfect-scrollbar.min.js"></script>
	<script src="/assets/js/bootstrap.bundle.min.js"></script>
	<script src="/assets/vendors/apexcharts/apexcharts.js"></script>
	<script src="/assets/js/pages/dashboard.js"></script>
	<script src="/assets/js/vacancyform.js"></script>
	<script
		src="https://cdn.jsdelivr.net/npm/boxicons@2.1.4/dist/boxicons.min.js"></script>
	<script src="assets/vendors/summernote/summernote-lite.min.js"></script>

	<script type="text/javascript"
		src="https://code.jquery.com/jquery-3.5.1.js"></script>

	<script src="/assets/js/main.js"></script>
	<script src="assets/vendors/summernote/summernote-lite.min.js"></script>
	<script src="/assets/ajax/jquery.spring-friendly.js"
		type="text/javascript"></script>
<<<<<<< HEAD
	<script>
		$('.summernote').summernote({
			tabsize : 2,
			height : 110,
		})

		var table;
		$(document).ready(function() {
							table = $('#table1').DataTable(
								{
								"serverSide" : true,
								"processing" : true,
								"ajax" : '/allCandidate',
								      
								
								"columns" : [
								{
									targets : 0,
									data : "id",
									render : function(
									data, type,row) 
									{return '<input type="checkbox" class="ck" value="' + data + '">';},
									sortable : false,visible : true,},
														{
															data : "id",
															targets : 1
														},
														{
															data : "summary.name",
															targets : 2
														},
														{
															data : "summary.email",
															targets : 3
														},
														
														{
														    targets: 4,
														    data: "selectionStatus",
														    
														},
														{
															targets : 5,
															data:"summary.email",
															render : function(
																	data, type,
																	row) {
																return '<a  data-bs-toggle="modal" data-bs-target="#emailModal" data-modal-title="Interview Invert Mail" class="btn btn-outline-primary btn-sm btn-block">Send Invert Mail</a>';
															},
															sortable : false
														},
														{
															
															data : "interviewStatus",
															targets : 6,
															render : function(data, type,row) {
																return '<select id="changeStatus">' +
													            '<option value="NONE"' + (data === 'NONE' ? ' selected' : '') + ' >NONE</option>' +
													            '<option value="PENDING"' + (data === 'PENDING' ? ' selected' : '') + '>PENDING</option>' +
													            '<option value="PASSED"' + (data === 'PASSED' ? ' selected' : '') + '>PASSED</option>' +
													            '<option value="CANCEL"' + (data === 'CANCEL' ? ' selected' : '') + '>CANCEL</option>' +
													           
													            
													            '</select>';
															},
															sortable : false
															
														},
														{
															targets : 7,
															data:"summary.email",
															render : function(data, type,row) {
																return '<a  data-bs-toggle="modal" data-bs-target="#emailModal" data-modal-title="Job Offer Mail" class="btn btn-outline-primary btn-sm btn-block">Send Offer Mail</a>';
															},
															sortable : false
														},
														{
															targets : 8,
															data:'id',
															render : function(data, type,row) {
																return '<a href="#" class="btn btn-outline-primary btn-sm btn-block seeMoreBtn">See More</a>';

															}
														},
														{
															targets:9,
															data:"vacancyDepartment.vacancy.position.name"
															
														}

												],

											});
							 $('#positionSelect').on('change', function(){
							       table.column(9).search(this.value).draw();   
							    });
							

							
							$('#selectAll').on(
									'change',
									function() {
										var checkboxes = $('#table1').find(
												':checkbox');
										checkboxes
												.prop('checked', this.checked);
										checkboxes.closest('tbody tr')
												.toggleClass('selected-row',
														this.checked);
									});

							$('#table1')
									.on(
											'change',
											':checkbox',
											function() {
												var checkboxes = $('#table1')
														.find(':checkbox');
												var selectAllCheckbox = $('#selectAll');
												if (!this.checked) {
													selectAllCheckbox.prop(
															'checked', false);

												} else {
													selectAllCheckbox
															.prop(
																	'checked',
																	checkboxes.length === checkboxes
																			.filter(':checked').length);
												}
												$(this).closest('tbody tr')
														.toggleClass(
																'selected-row',
																this.checked);
											});

							$('#table1 tbody').on('click','.btn-outline-primary',
									function() {
										var modalTitle = $(this).data(
												'modal-title');
										  var row = table.row($(this).closest('tr')).data();
										  console.log(row.summary.dob);
										  console.log(email);
										$('#emailModal .modal-title').text(
												modalTitle);
										$('#emailModal .candidatEmail').val(row.summary.email);
										$("#emailModal .userEmail").val(row.vacancyDepartment.vacancy.createdUser.email);
									});
							
							// Function to get the CSRF token from the cookie
							function getCsrfToken() {
 							 const metaTag = document.querySelector('meta[name="_csrf"]');
  								return metaTag ? metaTag.getAttribute('content') : null;
													}

							$('#table1 tbody').on('click', '.seeMoreBtn',
									function() {
										var tr = $(this).closest('tr');
										var row = table.row(tr).data();
											$('#seeMoreModal').modal('show');
										const csrfToken = getCsrfToken();
										var id= row.id;
										
										if(row.selectionStatus=='RECEIVED'){
											console.log(row.selectionStatus)
										fetch('/changStatus',{
											method:'POST',
											headers:{
												'Content-Type': 'application/json;charset=utf-8',
									            'X-XSRF-Token':csrfToken
											},
											 body: JSON.stringify(id) 
										})	
										.then(response =>{
											if (response.ok){
												console.log("Change SelectStatus");
												 $('table#table1').DataTable().ajax.reload(null, false);
											}
											else{
												console.log("Error change SelectStatus");
											}
										})
										}
										
										else{
											   fetch('/seeMore', {
											        method: 'POST',
											        headers: {
											            'Content-Type': 'application/json;charset=utf-8',
											            'X-XSRF-Token':csrfToken
											           
											        },
											        body: JSON.stringify(id) 
											    })
											    .then(response => {
											        if (response.ok) {
											            return response.json();
											            
											        } else {
											            console.error("Fail");
											        }
											    })
											    .then(candidateData => {
											    	console.log(candidateData);
 													 $('#name').html(candidateData.name);
 													 $('#email').html(candidateData.email);
 													 $('#phone').html(candidateData.phone);
 													 $('#dob').html(candidateData.dob);
 													 $('#gender').html(candidateData.gender);
 													 $('#education').html(candidateData.education);
 													 $('#applyPosition').html(candidateData.apply_position);
 													 $('#expectedSalary').html(candidateData.expectedSalary);
 													 $('#experience').html(candidateData.experience);
 													 $('#level').html(candidateData.lvl);
 													 $('#specialist').html(candidateData.specialist_tech);
													})
											    .catch(error => {
											        console.error("Error:", error);
											    });
										}
										 
									});
							$.ajax({
							    url: '/allPositions',
							    type: 'GET',
							    success: function(response) {
							        
							        const selectElement = $('#positionSelect');
							        $.each(response, function(index, position) {
							            const option = $('<option>').val(position.name).text(position.name);
							            selectElement.append(option);
							            
							        });
							    },
							    error: function(xhr, status, error) {
							    	console.log(status);
							        console.error('Error fetching positions:', error);
							    }
							});
							
							function non(){
								console.log("helllllllooooo");
								fetch('/changeInterview',{
									method:'POST',
									headers:{
										'Content-Type': 'application/json;charset=utf-8',
							            'X-XSRF-Token':csrfToken
									},
									 body: JSON.stringify(id) 
										
								})    
								.then(response => {
							        if (response.ok) {
							            console.log('Success');
							            
							        } else {
							            console.error("Fail");
							        }
								})
							}
							

						});
		document.addEventListener('DOMContentLoaded', function () {
		    // Get the button element
		    const fetchValueButton = document.getElementById('fetchValueButton');
		    const interviewStatusSelect = document.getElementById('changeStatus');
	        
	        interviewStatusSelect.addEventListener('change', function () {
	            const selectedValue = interviewStatusSelect.value;
	            non(selectedValue);
	        });
	    });

	    function non(status) {
	        console.log("helllllllooooo");
	        fetch('/changeInterview', {
	            method: 'POST',
	            headers: {
	                'Content-Type': 'application/json;charset=utf-8',
	                'X-XSRF-Token': csrfToken
	            },
	            body: JSON.stringify({ id: status })
	        })
	        .then(response => {
	            if (response.ok) {
	                console.log('Success');
	            } else {
	                console.error("Fail");
	            }
	        });
	    }
		    // Add a click event listener to the button
		    fetchValueButton.addEventListener('click', function () {
		      // Get the value of the input with id="time"
		      const timeInputValue = document.getElementById('time').value;

		      // Do something with the value (e.g., display it in an alert)
		      alert('Value of time: ' + timeInputValue);
		    });
		  
		
	</script>
=======
		<script src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.5/js/dataTables.bootstrap5.min.js"></script>
		<script src="/assets/js/javaScript/allCandidate.js"></script>
		
    <script src="assets/vendors/sweetalert2/sweetalert2.all.min.js"></script>

>>>>>>> backup





</body>

</html>